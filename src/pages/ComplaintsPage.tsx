import React, { useMemo, useState } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { mockFeedbackData } from "@/data/mockData";
import { FeedbackEntry } from "@/types/dashboard";

/* -------------------------------------------------------------------------- */
/*  1) วาง “ตารางภาค/เขต/สาขา” ของคุณลงในตัวแปร CSV_TEXT ด้านล่างนี้           */
/*     (รองรับทั้ง CSV คั่นด้วย , และ TSV คั่นด้วย \t — ของคุณเป็นแท็บให้วางได้เลย)  */
/* -------------------------------------------------------------------------- */
const CSV_TEXT = `
ภาค	เขต	หน่วยให้บริการ
ภาค 1	0	สำนักพหลโยธิน
ภาค 1	บางเขน	กรีนพลาซ่า (วังหิน)
ภาค 1	บางเขน	จตุจักร
ภาค 1	บางเขน	ตลาด อ.ต.ก.
ภาค 1	บางเขน	บางเขน
ภาค 1	บางเขน	ประชาชื่น
ภาค 1	บางเขน	ประชานิเวศน์ 1
ภาค 1	บางเขน	พงษ์เพชร
ภาค 1	บางเขน	มหาวิทยาลัยเกษตรศาสตร์
ภาค 1	บางเขน	มาร์เก็ต เพลส วงศ์สว่าง
ภาค 1	บางเขน	อเวนิว รัชโยธิน
ภาค 1	บางเขน	เซ็นทรัล ลาดพร้าว
ภาค 1	บางเขน	เตาปูน
ภาค 1	บางเขน	เอนเนอร์ยี่ คอมเพล็กซ์
ภาค 1	ราชวัตร	ถนนประดิพัทธ์
ภาค 1	ราชวัตร	ทำเนียบรัฐบาล
ภาค 1	ราชวัตร	นางเลิ้ง
ภาค 1	ราชวัตร	มหานาค
ภาค 1	ราชวัตร	ราชวัตร
ภาค 1	ราชวัตร	ศรีย่าน
ภาค 1	ราชวัตร	สวนจิตรลดา
ภาค 1	ราชวัตร	สุพรีม คอมเพล็กซ์ สามเสน
ภาค 1	ราชวัตร	แยกพิชัย
ภาค 1	สะพานใหม่	กรมการกงสุล
ภาค 1	สะพานใหม่	ดอนเมือง
ภาค 1	สะพานใหม่	ตลาดยิ่งเจริญ
ภาค 1	สะพานใหม่	ตลาดวงศกร
ภาค 1	สะพานใหม่	ถนนสรงประภา
ภาค 1	สะพานใหม่	บิ๊กซี แจ้งวัฒนะ
ภาค 1	สะพานใหม่	วัชรพล
ภาค 1	สะพานใหม่	ศูนย์ราชการเฉลิมพระเกียรติ แจ้งวัฒนะ (อาคาร A)
ภาค 1	สะพานใหม่	ศูนย์ราชการเฉลิมพระเกียรติ แจ้งวัฒนะ (อาคาร B)
ภาค 1	สะพานใหม่	สะพานใหม่
ภาค 1	สะพานใหม่	อนุสรณ์สถานแห่งชาติ
ภาค 1	สะพานใหม่	เดอะแจส รามอินทรา
ภาค 1	สะพานใหม่	ไอที สแควร์
ภาค 1	ห้วยขวาง	กระทรวงการคลัง
ภาค 1	ห้วยขวาง	ชัยสมรภูมิ
ภาค 1	ห้วยขวาง	ดินแดง
ภาค 1	ห้วยขวาง	บิ๊กซี ลาดพร้าว 2
ภาค 1	ห้วยขวาง	พญาไท
ภาค 1	ห้วยขวาง	ยุติธรรม
ภาค 1	ห้วยขวาง	ลาดพร้าว
ภาค 1	ห้วยขวาง	ห้วยขวาง
ภาค 1	ห้วยขวาง	อีสท์วอเตอร์
ภาค 1	ห้วยขวาง	เซ็นทรัล พระราม 9
ภาค 1	ห้วยขวาง	เอสพละนาด รัชดาภิเษก
ภาค 10	นครพนม	ธาตุพนม
ภาค 10	นครพนม	นครพนม
ภาค 10	นครพนม	นาหว้า
ภาค 10	นครพนม	นาแก
ภาค 10	นครพนม	บ้านแพง
ภาค 10	นครพนม	ปลาปาก
ภาค 10	นครพนม	ศรีสงคราม
ภาค 10	นครพนม	เรณูนคร
ภาค 10	บึงกาฬ	บึงกาฬ
ภาค 10	บึงกาฬ	ปากคาด
ภาค 10	บึงกาฬ	พรเจริญ
ภาค 10	บึงกาฬ	เซกา
ภาค 10	บึงกาฬ	โซ่พิสัย
ภาค 10	สกลนคร	กุสุมาลย์
ภาค 10	สกลนคร	คำตากล้า
ภาค 10	สกลนคร	ถนนประชาราษฎร์
ภาค 10	สกลนคร	บ้านม่วง
ภาค 10	สกลนคร	พังโคน
ภาค 10	สกลนคร	วานรนิวาส
ภาค 10	สกลนคร	สกลนคร
ภาค 10	สกลนคร	สว่างแดนดิน
ภาค 10	สกลนคร	อากาศอำนวย
ภาค 10	สกลนคร	โรบินสัน สกลนคร
ภาค 10	หนองคาย	ท่าบ่อ
ภาค 10	หนองคาย	ศรีเชียงใหม่
ภาค 10	หนองคาย	หนองคาย
ภาค 10	หนองคาย	อัศวรรณ ช้อปปิ้ง คอมเพล็กซ์ หนองคาย
ภาค 10	หนองคาย	โพนพิสัย
ภาค 10	หนองบัวลำภู	นากลาง
ภาค 10	หนองบัวลำภู	ศรีบุญเรือง
ภาค 10	หนองบัวลำภู	สุวรรณคูหา
ภาค 10	หนองบัวลำภู	โนนสัง
ภาค 10	อุดรธานี 1	น้ำโสม
ภาค 10	อุดรธานี 1	บงคำ
ภาค 10	อุดรธานี 1	บ้านผือ
ภาค 10	อุดรธานี 1	ยูดี ทาวน์ อุดรธานี
ภาค 10	อุดรธานี 1	อุดรธานี
ภาค 10	อุดรธานี 1	เซ็นทรัล อุดรธานี
ภาค 10	อุดรธานี 2	กุมภวาปี
ภาค 10	อุดรธานี 2	บ้านดุง
ภาค 10	อุดรธานี 2	วังสามหมอ
ภาค 10	อุดรธานี 2	ศรีธาตุ
ภาค 10	อุดรธานี 2	หนองหาน
ภาค 10	อุดรธานี 2	เพ็ญ
ภาค 10	อุดรธานี 2	โนนสะอาด
ภาค 10	เลย	ด่านซ้าย
ภาค 10	เลย	ท่าลี่
ภาค 10	เลย	นาอาน
ภาค 10	เลย	ปากชม
ภาค 10	เลย	ภูกระดึง
ภาค 10	เลย	ภูเรือ
ภาค 10	เลย	วังสะพุง
ภาค 10	เลย	เลย
ภาค 11	กาฬสินธุ์	กมลาไสย
ภาค 11	กาฬสินธุ์	กาฬสินธุ์
ภาค 11	กาฬสินธุ์	กุฉินารายณ์
ภาค 11	กาฬสินธุ์	คำม่วง
ภาค 11	กาฬสินธุ์	ถีนานนท์
ภาค 11	กาฬสินธุ์	ท่าคันโท
ภาค 11	กาฬสินธุ์	ยางตลาด
ภาค 11	กาฬสินธุ์	สมเด็จ
ภาค 11	กาฬสินธุ์	หนองกุงศรี
ภาค 11	กาฬสินธุ์	เขาวง
ภาค 11	กาฬสินธุ์	โลตัส กาฬสินธุ์
ภาค 11	ขอนแก่น 1	กระนวน
ภาค 11	ขอนแก่น 1	ขอนแก่น
ภาค 11	ขอนแก่น 1	น้ำพอง
ภาค 11	ขอนแก่น 1	บ้านไผ่
ภาค 11	ขอนแก่น 1	ประตูน้ำขอนแก่น
ภาค 11	ขอนแก่น 1	ศูนย์ราชการ
ภาค 11	ขอนแก่น 1	อุบลรัตน์
ภาค 11	ขอนแก่น 1	เขาสวนกวาง
ภาค 11	ขอนแก่น 1	เซ็นทรัล ขอนแก่น
ภาค 11	ขอนแก่น 2	ชุมแพ
ภาค 11	ขอนแก่น 2	พล
ภาค 11	ขอนแก่น 2	ภูผาม่าน
ภาค 11	ขอนแก่น 2	ภูเวียง
ภาค 11	ขอนแก่น 2	มัญจาคีรี
ภาค 11	ขอนแก่น 2	สีชมพู
ภาค 11	ขอนแก่น 2	หนองสองห้อง
ภาค 11	ขอนแก่น 2	หนองเรือ
ภาค 11	ชัยภูมิ	คอนสวรรค์
ภาค 11	ชัยภูมิ	จัตุรัส
ภาค 11	ชัยภูมิ	ชัยภูมิ
ภาค 11	ชัยภูมิ	บำเหน็จณรงค์
ภาค 11	ชัยภูมิ	บ้านเขว้า
ภาค 11	ชัยภูมิ	ภูเขียว
ภาค 11	ชัยภูมิ	หนองบัวระเหว
ภาค 11	ชัยภูมิ	หนองบัวแดง
ภาค 11	ชัยภูมิ	ห้าแยกโนนไฮ
ภาค 11	ชัยภูมิ	เกษตรสมบูรณ์
ภาค 11	ชัยภูมิ	เทพสถิต
ภาค 11	ชัยภูมิ	แก้งคร้อ
ภาค 11	มหาสารคาม	ท่าขอนยาง
ภาค 11	มหาสารคาม	นาเชือก
ภาค 11	มหาสารคาม	บรบือ
ภาค 11	มหาสารคาม	พยัคฆภูมิพิสัย
ภาค 11	มหาสารคาม	มหาสารคาม
ภาค 11	มหาสารคาม	วาปีปทุม
ภาค 11	มหาสารคาม	เชียงยืน
ภาค 11	มหาสารคาม	เสริมไทยคอมเพล็กซ์
ภาค 11	มหาสารคาม	โกสุมพิสัย
ภาค 11	มุกดาหาร	คำชะอี
ภาค 11	มุกดาหาร	ดอนตาล
ภาค 11	มุกดาหาร	ตลาดพรเพชร
ภาค 11	มุกดาหาร	นิคมคำสร้อย
ภาค 11	มุกดาหาร	บิ๊กซี มุกดาหาร
ภาค 11	มุกดาหาร	มุกดาหาร
ภาค 11	ร้อยเอ็ด	จตุรพักตรพิมาน
ภาค 11	ร้อยเอ็ด	ปทุมรัตต์
ภาค 11	ร้อยเอ็ด	พนมไพร
ภาค 11	ร้อยเอ็ด	ร้อยเอ็ด
ภาค 11	ร้อยเอ็ด	สี่แยกโรงพยาบาลร้อยเอ็ด
ภาค 11	ร้อยเอ็ด	สุวรรณภูมิ
ภาค 11	ร้อยเอ็ด	หนองพอก
ภาค 11	ร้อยเอ็ด	อาจสามารถ
ภาค 11	ร้อยเอ็ด	เกษตรวิสัย
ภาค 11	ร้อยเอ็ด	เทวาภิบาล
ภาค 11	ร้อยเอ็ด	เสลภูมิ
ภาค 11	ร้อยเอ็ด	โพธิ์ชัย
ภาค 11	ร้อยเอ็ด	โพนทอง
ภาค 11	ร้อยเอ็ด	โรบินสัน ร้อยเอ็ด
ภาค 12	บุรีรัมย์	กระสัง
ภาค 12	บุรีรัมย์	นางรอง
ภาค 12	บุรีรัมย์	บุรีรัมย์
ภาค 12	บุรีรัมย์	บ้านกรวด
ภาค 12	บุรีรัมย์	บ้านใหม่ไชยพจน์
ภาค 12	บุรีรัมย์	ประโคนชัย
ภาค 12	บุรีรัมย์	ละหานทราย
ภาค 12	บุรีรัมย์	ลำปลายมาศ
ภาค 12	บุรีรัมย์	สตึก
ภาค 12	บุรีรัมย์	โรบินสัน บุรีรัมย์
ภาค 12	ยโสธร	กุดชุม
ภาค 12	ยโสธร	คำเขื่อนแก้ว
ภาค 12	ยโสธร	ถนนวิทยะธำรงค์
ภาค 12	ยโสธร	ปทุมราชวงศา
ภาค 12	ยโสธร	มหาชนะชัย
ภาค 12	ยโสธร	ยโสธร
ภาค 12	ยโสธร	ลืออำนาจ
ภาค 12	ยโสธร	อำนาจเจริญ
ภาค 12	ยโสธร	เลิงนกทา
ภาค 12	ศรีสะเกษ	กันทรลักษ์
ภาค 12	ศรีสะเกษ	กันทรารมย์
ภาค 12	ศรีสะเกษ	ขุขันธ์
ภาค 12	ศรีสะเกษ	ขุนหาญ
ภาค 12	ศรีสะเกษ	ถนนเทพา
ภาค 12	ศรีสะเกษ	ราษีไศล
ภาค 12	ศรีสะเกษ	ศรีสะเกษ
ภาค 12	ศรีสะเกษ	อุทุมพรพิสัย
ภาค 12	สุรินทร์	จอมพระ
ภาค 12	สุรินทร์	ชุมพลบุรี
ภาค 12	สุรินทร์	ท่าตูม
ภาค 12	สุรินทร์	ปราสาท
ภาค 12	สุรินทร์	รัตนบุรี
ภาค 12	สุรินทร์	ศีขรภูมิ
ภาค 12	สุรินทร์	สังขะ
ภาค 12	สุรินทร์	สุรินทร์
ภาค 12	สุรินทร์	แยกหนองบัว
ภาค 12	สุรินทร์	โรบินสัน สุรินทร์
ภาค 12	อุบลราชธานี 1	กุดข้าวปุ้น
ภาค 12	อุบลราชธานี 1	ซิตี้มอลล์ อุบลราชธานี
ภาค 12	อุบลราชธานี 1	ดอนมดแดง
ภาค 12	อุบลราชธานี 1	ตระการพืชผล
ภาค 12	อุบลราชธานี 1	ถนนยุทธภัณฑ์
ภาค 12	อุบลราชธานี 1	ถนนแจ้งสนิท
ภาค 12	อุบลราชธานี 1	ม่วงสามสิบ
ภาค 12	อุบลราชธานี 1	ศรีเมืองใหม่
ภาค 12	อุบลราชธานี 1	อุบลราชธานี
ภาค 12	อุบลราชธานี 1	เขมราฐ
ภาค 12	อุบลราชธานี 1	เซ็นทรัล อุบลราชธานี
ภาค 12	อุบลราชธานี 1	โพธิ์ไทร
ภาค 12	อุบลราชธานี 2	ถนนสถลมาร์ค
ภาค 12	อุบลราชธานี 2	ถนนสถิตย์นิมานกาล
ภาค 12	อุบลราชธานี 2	นาจะหลวย
ภาค 12	อุบลราชธานี 2	น้ำยืน
ภาค 12	อุบลราชธานี 2	พิบูลมังสาหาร
ภาค 12	อุบลราชธานี 2	วารินชำราบ
ภาค 12	อุบลราชธานี 2	เขื่องใน
ภาค 12	อุบลราชธานี 2	เดชอุดม
ภาค 12	อุบลราชธานี 2	โขงเจียม
ภาค 12	อุบลราชธานี 2	โนนผึ้ง
ภาค 13	นครราชสีมา 1	ครบุรี
ภาค 13	นครราชสีมา 1	ชุมพวง
ภาค 13	นครราชสีมา 1	ตลาดเซฟวัน
ภาค 13	นครราชสีมา 1	บัวใหญ่
ภาค 13	นครราชสีมา 1	ประทาย
ภาค 13	นครราชสีมา 1	มุขมนตรี
ภาค 13	นครราชสีมา 1	สุรนารี
ภาค 13	นครราชสีมา 1	หนองบุญมาก
ภาค 13	นครราชสีมา 1	เซ็นทรัล โคราช
ภาค 13	นครราชสีมา 1	เดอะมอลล์ นครราชสีมา
ภาค 13	นครราชสีมา 1	เสิงสาง
ภาค 13	นครราชสีมา 1	โคกกรวด
ภาค 13	นครราชสีมา 1	โชคชัย
ภาค 13	นครราชสีมา 2	คง
ภาค 13	นครราชสีมา 2	จักราช
ภาค 13	นครราชสีมา 2	ถนนจอมพล
ภาค 13	นครราชสีมา 2	นครราชสีมา
ภาค 13	นครราชสีมา 2	บัวลาย
ภาค 13	นครราชสีมา 2	ประตูชุมพล
ภาค 13	นครราชสีมา 2	พิมาย
ภาค 13	นครราชสีมา 2	หัวทะเล
ภาค 13	นครราชสีมา 2	ห้วยแถลง
ภาค 13	นครราชสีมา 2	เทอมินอล21 โคราช
ภาค 13	นครราชสีมา 2	แก้งสนามนาง
ภาค 13	นครราชสีมา 2	โนนสูง
ภาค 13	นครราชสีมา 2	โนนไทย
ภาค 13	นครราชสีมา 3	กลางดง
ภาค 13	นครราชสีมา 3	ด่านขุนทด
ภาค 13	นครราชสีมา 3	ธนะรัชต์ เขาใหญ่
ภาค 13	นครราชสีมา 3	ปักธงชัย
ภาค 13	นครราชสีมา 3	ปากช่อง
ภาค 13	นครราชสีมา 3	วังน้ำเขียว
ภาค 13	นครราชสีมา 3	สีคิ้ว
ภาค 13	นครราชสีมา 3	สูงเนิน
ภาค 13	นครราชสีมา 3	โลตัส ปากช่อง
ภาค 13	ปราจีนบุรี	กบินทร์บุรี
ภาค 13	ปราจีนบุรี	นครนายก
ภาค 13	ปราจีนบุรี	นิคมอุตสาหกรรม 304
ภาค 13	ปราจีนบุรี	บ้านนา
ภาค 13	ปราจีนบุรี	ประจันตคาม
ภาค 13	ปราจีนบุรี	ปราจีนบุรี
ภาค 13	ปราจีนบุรี	ศรีมหาโพธิ
ภาค 13	ปราจีนบุรี	องครักษ์
ภาค 13	ปราจีนบุรี	โรบินสัน ปราจีนบุรี
ภาค 13	สระแก้ว	ตลาดโรงเกลือ
ภาค 13	สระแก้ว	วังน้ำเย็น
ภาค 13	สระแก้ว	วังสมบูรณ์
ภาค 13	สระแก้ว	วัฒนานคร
ภาค 13	สระแก้ว	สระแก้ว
ภาค 13	สระแก้ว	อรัญประเทศ
ภาค 14	ปทุมธานี 1	ตลาดพูนทรัพย์
ภาค 14	ปทุมธานี 1	ตลาดไท
ภาค 14	ปทุมธานี 1	ทียูโดม รังสิต
ภาค 14	ปทุมธานี 1	นวนคร
ภาค 14	ปทุมธานี 1	บิ๊กซี รังสิต 2
ภาค 14	ปทุมธานี 1	ปทุมธานี
ภาค 14	ปทุมธานี 1	รังสิต
ภาค 14	ปทุมธานี 1	ลาดหลุมแก้ว
ภาค 14	ปทุมธานี 1	สามโคก
ภาค 14	ปทุมธานี 1	หมู่บ้านเมืองเอก
ภาค 14	ปทุมธานี 2	คลอง 10 ธัญบุรี
ภาค 14	ปทุมธานี 2	คลองหลวง
ภาค 14	ปทุมธานี 2	บิ๊กซี ลำลูกกา 1
ภาค 14	ปทุมธานี 2	บิ๊กซี ลำลูกกา 2
ภาค 14	ปทุมธานี 2	ฟิวเจอร์พาร์ค รังสิต
ภาค 14	ปทุมธานี 2	ลำลูกกา
ภาค 14	ปทุมธานี 2	ลำไทร
ภาค 14	ปทุมธานี 2	สัมมากร เพลส รังสิต คลอง 2
ภาค 14	ปทุมธานี 2	เมเจอร์ รังสิต
ภาค 14	ปทุมธานี 2	โลตัส รังสิตคลอง 7
ภาค 14	พระนครศรีอยุธยา 1	คลองสวนพลู
ภาค 14	พระนครศรีอยุธยา 1	ท่าเรือ (อยุธยา)
ภาค 14	พระนครศรีอยุธยา 1	นครหลวง
ภาค 14	พระนครศรีอยุธยา 1	นิคมอุตสาหกรรมบางปะอิน
ภาค 14	พระนครศรีอยุธยา 1	บางปะอิน
ภาค 14	พระนครศรีอยุธยา 1	ประตูน้ำพระอินทร์
ภาค 14	พระนครศรีอยุธยา 1	ภาชี
ภาค 14	พระนครศรีอยุธยา 1	วังน้อย
ภาค 14	พระนครศรีอยุธยา 1	อยุธยาพาร์ค
ภาค 14	พระนครศรีอยุธยา 1	อุทัย
ภาค 14	พระนครศรีอยุธยา 2	บางปะหัน
ภาค 14	พระนครศรีอยุธยา 2	บ้านแพรก
ภาค 14	พระนครศรีอยุธยา 2	ผักไห่
ภาค 14	พระนครศรีอยุธยา 2	พระนครศรีอยุธยา
ภาค 14	พระนครศรีอยุธยา 2	มหาราช
ภาค 14	พระนครศรีอยุธยา 2	ลาดบัวหลวง
ภาค 14	พระนครศรีอยุธยา 2	สวนอุตสาหกรรมโรจนะ
ภาค 14	พระนครศรีอยุธยา 2	เจ้าพรหม
ภาค 14	พระนครศรีอยุธยา 2	เสนา
ภาค 14	สระบุรี	บ้านหมอ
ภาค 14	สระบุรี	พระพุทธบาท
ภาค 14	สระบุรี	มวกเหล็ก
ภาค 14	สระบุรี	วังม่วง
ภาค 14	สระบุรี	วิหารแดง
ภาค 14	สระบุรี	สระบุรี
ภาค 14	สระบุรี	สุขอนันต์ปาร์ค
ภาค 14	สระบุรี	หนองแค
ภาค 14	สระบุรี	หินกอง
ภาค 14	สระบุรี	เสาไห้
ภาค 14	สระบุรี	แก่งคอย
ภาค 14	สระบุรี	โรบินสัน สระบุรี
ภาค 14	อ่างทอง	ท็อปส์ พลาซ่า สิงห์บุรี
ภาค 14	อ่างทอง	ท่าช้าง
ภาค 14	อ่างทอง	บางระจัน
ภาค 14	อ่างทอง	ป่าโมก
ภาค 14	อ่างทอง	วิเศษชัยชาญ
ภาค 14	อ่างทอง	สิงห์บุรี
ภาค 14	อ่างทอง	อินทร์บุรี
ภาค 14	อ่างทอง	อ่างทอง
ภาค 14	อ่างทอง	โพธิ์ทอง
ภาค 15	จันทบุรี	ขลุง
ภาค 15	จันทบุรี	คลองใหญ่
ภาค 15	จันทบุรี	จันทบุรี
ภาค 15	จันทบุรี	ชัยมงคล - ตราด
ภาค 15	จันทบุรี	ตราด
ภาค 15	จันทบุรี	ตลาดเทศบาล 2
ภาค 15	จันทบุรี	ถนนท่าแฉลบ
ภาค 15	จันทบุรี	ท่าใหม่
ภาค 15	จันทบุรี	สอยดาว
ภาค 15	จันทบุรี	ห้วยสะท้อน
ภาค 15	จันทบุรี	เกาะกูด
ภาค 15	จันทบุรี	เกาะช้าง
ภาค 15	จันทบุรี	เขาคิชฌกู
ภาค 15	จันทบุรี	เขาคิชฌกูฏ
ภาค 15	จันทบุรี	เขาสมิง
ภาค 15	จันทบุรี	เรนโบว์ พลาซา จันทบุรี
ภาค 15	ฉะเชิงเทรา	ฉะเชิงเทรา
ภาค 15	ฉะเชิงเทรา	ถนนมหาจักรพรรดิ์
ภาค 15	ฉะเชิงเทรา	บางคล้า
ภาค 15	ฉะเชิงเทรา	บางน้ำเปรี้ยว
ภาค 15	ฉะเชิงเทรา	บางปะกง
ภาค 15	ฉะเชิงเทรา	พนมสารคาม
ภาค 15	ฉะเชิงเทรา	สนามชัยเขต
ภาค 15	ฉะเชิงเทรา	โรบินสัน ฉะเชิงเทรา
ภาค 15	ชลบุรี 1	ชลบุรี
ภาค 15	ชลบุรี 1	ถนนพระยาสัจจา
ภาค 15	ชลบุรี 1	ถนนสุขประยูร
ภาค 15	ชลบุรี 1	บางทราย
ภาค 15	ชลบุรี 1	ศรีราชา
ภาค 15	ชลบุรี 1	หนองมน
ภาค 15	ชลบุรี 1	ฮาร์เบอร์ มอลล์ แหลมฉบัง
ภาค 15	ชลบุรี 1	เซ็นทรัล ชลบุรี
ภาค 15	ชลบุรี 1	แปซิฟิค พาร์ค ศรีราชา
ภาค 15	ชลบุรี 2	ถนนทัพพระยา
ภาค 15	ชลบุรี 2	บางละมุง
ภาค 15	ชลบุรี 2	บิ๊กซี พัทยาใต้
ภาค 15	ชลบุรี 2	พัทยาใต้
ภาค 15	ชลบุรี 2	เซ็นทรัล พัทยา
ภาค 15	ชลบุรี 2	เมืองพัทยา
ภาค 15	ชลบุรี 2	โพธิสัมพันธ์
ภาค 15	ชลบุรี 3	ดอนหัวฬ่อ
ภาค 15	ชลบุรี 3	นิคมอุตสาหกรรมอมตะนคร
ภาค 15	ชลบุรี 3	บ้านบึง
ภาค 15	ชลบุรี 3	พนัสนิคม
ภาค 15	ชลบุรี 3	พานทอง
ภาค 15	ชลบุรี 3	หัวกุญแจ
ภาค 15	ชลบุรี 3	เกาะโพธิ์
ภาค 15	ชลบุรี 4	ตลาดบ้านอำเภอ
ภาค 15	ชลบุรี 4	บุญสัมพันธ์
ภาค 15	ชลบุรี 4	บ่อวิน
ภาค 15	ชลบุรี 4	สยามคันทรีคลับ
ภาค 15	ชลบุรี 4	สวนอุตสาหกรรมศรีราชา
ภาค 15	ชลบุรี 4	สัตหีบ
ภาค 15	ชลบุรี 4	สุขุมวิท - สัตหีบ
ภาค 15	ชลบุรี 4	เนินพลับหวาน
ภาค 15	ชลบุรี1	Exim Bank แหลมฉบัง
ภาค 15	ระยอง	นิคมพัฒนา ระยอง
ภาค 15	ระยอง	บ้านค่าย
ภาค 15	ระยอง	บ้านฉาง
ภาค 15	ระยอง	ปลวกแดง
ภาค 15	ระยอง	มาบตาพุด
ภาค 15	ระยอง	ระยอง
ภาค 15	ระยอง	เซ็นทรัล ระยอง
ภาค 15	ระยอง	เนินพระ
ภาค 15	ระยอง	เพ
ภาค 15	ระยอง	แกลง
ภาค 15	ระยอง	แพชชั่น ช้อปปิ้ง เดสติเนชั่น
ภาค 15	สมุทรปราการ 1	คลองด่าน
ภาค 15	สมุทรปราการ 1	ถนนกิ่งแก้ว-สุวรรณภูมิ
ภาค 15	สมุทรปราการ 1	นิคมอุตสาหกรรมบางปู
ภาค 15	สมุทรปราการ 1	นิคมอุตสาหกรรมบางพลี
ภาค 15	สมุทรปราการ 1	บางบ่อ
ภาค 15	สมุทรปราการ 1	บางพลี
ภาค 15	สมุทรปราการ 1	บิ๊กซี ศรีนครินทร์
ภาค 15	สมุทรปราการ 1	มาร์เก็ตวิลเลจ สุวรรณภูมิ
ภาค 15	สมุทรปราการ 1	สมุทรปราการ
ภาค 15	สมุทรปราการ 1	เทศบาลแพรกษา
ภาค 15	สมุทรปราการ 1	เมกาบางนา
ภาค 15	สมุทรปราการ 1	เมืองสมุทร
ภาค 15	สมุทรปราการ 1	โรบินสัน สมุทรปราการ
ภาค 15	สมุทรปราการ 2	บิ๊กซี สำโรง 2
ภาค 15	สมุทรปราการ 2	บิ๊กซี สุขสวัสดิ์
ภาค 15	สมุทรปราการ 2	ปู่เจ้าสมิงพราย
ภาค 15	สมุทรปราการ 2	พระประแดง
ภาค 15	สมุทรปราการ 2	พระสมุทรเจดีย์
ภาค 15	สมุทรปราการ 2	สำโรง
ภาค 15	สมุทรปราการ 2	สุขสวัสดิ์
ภาค 15	สมุทรปราการ 2	อิมพีเรียล เวิลด์ สำโรง
ภาค 16	ชุมพร 1	กระบุรี
ภาค 16	ชุมพร 1	ชุมพร
ภาค 16	ชุมพร 1	ถนนเรืองราษฎร์
ภาค 16	ชุมพร 1	ท่าแซะ
ภาค 16	ชุมพร 1	ปะทิว
ภาค 16	ชุมพร 1	ปากน้ำชุมพร
ภาค 16	ชุมพร 1	มาบอำมฤต
ภาค 16	ชุมพร 1	ระนอง
ภาค 16	ชุมพร 1	ศูนย์การค้าโอเชี่ยนคอมเพล็กซ์ ชุมพร
ภาค 16	ชุมพร 1	สุขสำราญ
ภาค 16	ชุมพร 2	ทุ่งตะโก
ภาค 16	ชุมพร 2	ปฐมพร
ภาค 16	ชุมพร 2	พะโต๊ะ
ภาค 16	ชุมพร 2	ละแม
ภาค 16	ชุมพร 2	สวี
ภาค 16	ชุมพร 2	หลังสวน
ภาค 16	พังงา	คุระบุรี
ภาค 16	พังงา	ตะกั่วป่า
ภาค 16	พังงา	ทับปุด
ภาค 16	พังงา	ท้ายเหมือง
ภาค 16	พังงา	พังงา
ภาค 16	พังงา	ย่านยาว
ภาค 16	พังงา	เกาะยาว
ภาค 16	พังงา	เขาหลัก
ภาค 16	พังงา	โคกกลอย
ภาค 16	ภูเก็ต	กะทู้
ภาค 16	ภูเก็ต	กะรน
ภาค 16	ภูเก็ต	ถนนพูนผล
ภาค 16	ภูเก็ต	ถนนเทพกระษัตรี
ภาค 16	ภูเก็ต	ถลาง
ภาค 16	ภูเก็ต	ป่าตอง
ภาค 16	ภูเก็ต	ภูเก็ต
ภาค 16	ภูเก็ต	สามกอง
ภาค 16	ภูเก็ต	สี่แยกท่าเรือ
ภาค 16	ภูเก็ต	ห้าแยกฉลอง
ภาค 16	ภูเก็ต	เชิงทะเล
ภาค 16	ภูเก็ต	เซ็นทรัลภูเก็ต เฟสติวัล
ภาค 16	ภูเก็ต	เทศบาลวิชิต
ภาค 16	สุราษฎร์ธานี 1	กาญจนดิษฐ์
ภาค 16	สุราษฎร์ธานี 1	ขุนทะเล
ภาค 16	สุราษฎร์ธานี 1	ดอนสัก
ภาค 16	สุราษฎร์ธานี 1	ถนนกาญจนวิถี
ภาค 16	สุราษฎร์ธานี 1	ถนนราษฎร์อุทิศ
ภาค 16	สุราษฎร์ธานี 1	บ่อผุด
ภาค 16	สุราษฎร์ธานี 1	บ้านนาสาร
ภาค 16	สุราษฎร์ธานี 1	บ้านนาเดิม
ภาค 16	สุราษฎร์ธานี 1	ละไม
ภาค 16	สุราษฎร์ธานี 1	สุราษฎร์ธานี
ภาค 16	สุราษฎร์ธานี 1	เกาะพะงัน
ภาค 16	สุราษฎร์ธานี 1	เกาะสมุย
ภาค 16	สุราษฎร์ธานี 1	เซ็นทรัล สมุย
ภาค 16	สุราษฎร์ธานี 1	เซ็นทรัล สุราษฎร์ธานี
ภาค 16	สุราษฎร์ธานี 1	เวียงสระ
ภาค 16	สุราษฎร์ธานี 2	คีรีรัฐนิคม
ภาค 16	สุราษฎร์ธานี 2	ชัยบุรี
ภาค 16	สุราษฎร์ธานี 2	ท่าฉาง
ภาค 16	สุราษฎร์ธานี 2	ท่าชนะ
ภาค 16	สุราษฎร์ธานี 2	บางสวรรค์
ภาค 16	สุราษฎร์ธานี 2	บ้านตาขุน
ภาค 16	สุราษฎร์ธานี 2	พนม
ภาค 16	สุราษฎร์ธานี 2	พระแสง
ภาค 16	สุราษฎร์ธานี 2	พุนพิน
ภาค 16	สุราษฎร์ธานี 2	วิภาวดี
ภาค 16	สุราษฎร์ธานี 2	เคียนซา
ภาค 16	สุราษฎร์ธานี 2	ไชยา
ภาค 17	กระบี่	กระบี่
ภาค 17	กระบี่	คลองท่อม
ภาค 17	กระบี่	ตลาดเก่า
ภาค 17	กระบี่	บิ๊กซี กระบี่
ภาค 17	กระบี่	ปลายพระยา
ภาค 17	กระบี่	ลำทับ
ภาค 17	กระบี่	อ่าวนาง
ภาค 17	กระบี่	อ่าวลึก
ภาค 17	กระบี่	เกาะลันตา
ภาค 17	กระบี่	เขาพนม
ภาค 17	กระบี่	เหนือคลอง
ภาค 17	กระบี่	โลตัส กระบี่
ภาค 17	ตรัง	กันตัง
ภาค 17	ตรัง	ตรัง
ภาค 17	ตรัง	ทุ่งยาว
ภาค 17	ตรัง	ย่านตาขาว
ภาค 17	ตรัง	รัษฎา
ภาค 17	ตรัง	สนามกีฬา ตรัง
ภาค 17	ตรัง	ห้วยยอด
ภาค 17	ตรัง	โรบินสัน ตรัง
ภาค 17	นครศรีธรรมราช 1	ขนอม
ภาค 17	นครศรีธรรมราช 1	ตลาดหัวอิฐ
ภาค 17	นครศรีธรรมราช 1	ท่าศาลา
ภาค 17	นครศรีธรรมราช 1	นครศรีธรรมราช
ภาค 17	นครศรีธรรมราช 1	นาหลวง
ภาค 17	นครศรีธรรมราช 1	ปากพนัง
ภาค 17	นครศรีธรรมราช 1	พรหมคีรี
ภาค 17	นครศรีธรรมราช 1	มหาวิทยาลัยวลัยลักษณ์
ภาค 17	นครศรีธรรมราช 1	ลานสกา
ภาค 17	นครศรีธรรมราช 1	สิชล
ภาค 17	นครศรีธรรมราช 1	หัวไทร
ภาค 17	นครศรีธรรมราช 1	เชียรใหญ่
ภาค 17	นครศรีธรรมราช 1	เซ็นทรัล นครศรีธรรมราช
ภาค 17	นครศรีธรรมราช 1	โรบินสัน นครศรีธรรมราช
ภาค 17	นครศรีธรรมราช 2	จันดี
ภาค 17	นครศรีธรรมราช 2	ฉวาง
ภาค 17	นครศรีธรรมราช 2	ชะอวด
ภาค 17	นครศรีธรรมราช 2	ถ้ำพรรณรา
ภาค 17	นครศรีธรรมราช 2	ทุ่งสง
ภาค 17	นครศรีธรรมราช 2	ทุ่งใหญ่
ภาค 17	นครศรีธรรมราช 2	บางขัน
ภาค 17	นครศรีธรรมราช 2	พิปูน
ภาค 17	นครศรีธรรมราช 2	ร่อนพิบูลย์
ภาค 17	นครศรีธรรมราช 2	ศูนย์การค้าไทยสมบูรณ์ทุ่งสง
ภาค 17	พัทลุง	ควนขนุน
ภาค 17	พัทลุง	ตะโหมด
ภาค 17	พัทลุง	ถนนนิวาส
ภาค 17	พัทลุง	ปากพะยูน
ภาค 17	พัทลุง	ป่าบอน
ภาค 17	พัทลุง	ป่าพะยอม
ภาค 17	พัทลุง	พัทลุง
ภาค 17	พัทลุง	ศรีนครินทร์
ภาค 17	พัทลุง	เขาชัยสน
ภาค 18	นราธิวาส	ตันหยงมัส
ภาค 18	นราธิวาส	ตากใบ
ภาค 18	นราธิวาส	นราธิวาส
ภาค 18	นราธิวาส	รือเสาะ
ภาค 18	นราธิวาส	สุคิริน
ภาค 18	นราธิวาส	สุริยะประดิษฐ์
ภาค 18	นราธิวาส	สุไหงปาดี
ภาค 18	นราธิวาส	สุไหงโก-ลก
ภาค 18	ปัตตานี	กรงปินัง
ภาค 18	ปัตตานี	กะพ้อ
ภาค 18	ปัตตานี	ถนนหนองจิก ปัตตานี
ภาค 18	ปัตตานี	ทุ่งยางแดง
ภาค 18	ปัตตานี	ธารโต
ภาค 18	ปัตตานี	บันนังสตา
ภาค 18	ปัตตานี	ปัตตานี
ภาค 18	ปัตตานี	ผังเมือง 4
ภาค 18	ปัตตานี	ยะลา
ภาค 18	ปัตตานี	ยะหา
ภาค 18	ปัตตานี	สายบุรี
ภาค 18	ปัตตานี	เบตง
ภาค 18	ปัตตานี	โคกโพธิ์
ภาค 18	สงขลา 1	คลองแงะ
ภาค 18	สงขลา 1	จะนะ
ภาค 18	สงขลา 1	ถนนกาญจนวณิช (สงขลา)
ภาค 18	สงขลา 1	นาทวี
ภาค 18	สงขลา 1	ปาดังเบซาร์
ภาค 18	สงขลา 1	ระโนด
ภาค 18	สงขลา 1	สงขลา
ภาค 18	สงขลา 1	สทิงพระ
ภาค 18	สงขลา 1	สะบ้าย้อย
ภาค 18	สงขลา 1	สะเดา
ภาค 18	สงขลา 1	สิงหนคร
ภาค 18	สงขลา 1	เทพา
ภาค 18	สงขลา 1	โลตัส สงขลา
ภาค 18	สงขลา 2	ควนเนียง
ภาค 18	สงขลา 2	ถนนกองบิน 56 (หาดใหญ่)
ภาค 18	สงขลา 2	ถนนลพบุรีราเมศวร์
ภาค 18	สงขลา 2	ท่าแพ (สตูล)
ภาค 18	สงขลา 2	บิ๊กซี เอ็กซ์ตร้า หาดใหญ่
ภาค 18	สงขลา 2	บ้านพรุ
ภาค 18	สงขลา 2	รัตภูมิ
ภาค 18	สงขลา 2	ราษฎร์อุทิศ หาดใหญ่
ภาค 18	สงขลา 2	ละงู
ภาค 18	สงขลา 2	ศรีภูวนารถ
ภาค 18	สงขลา 2	สตูล
ภาค 18	สงขลา 2	หาดใหญ่
ภาค 18	สงขลา 2	หาดใหญ่ใน
ภาค 18	สงขลา 2	เซ็นทรัล หาดใหญ่
ภาค 2	คลองจั่น	คลองจั่น
ภาค 2	คลองจั่น	รามอินทรา กม.7
ภาค 2	คลองจั่น	ลาดพร้าว 101
ภาค 2	คลองจั่น	สัมมากร เพลส รามคำแหง 110
ภาค 2	คลองจั่น	เซ็นทรัล รามอินทรา
ภาค 2	คลองจั่น	เซ็นทรัล อีสต์วิลล์
ภาค 2	คลองจั่น	เดอะคริสตัล
ภาค 2	คลองจั่น	เดอะพาซิโอ ทาวน์
ภาค 2	คลองจั่น	เดอะมอลล์ บางกะปิ
ภาค 2	คลองจั่น	โชคชัย 4
ภาค 2	ถนนเพชรบุรี	จักรวรรดิ
ภาค 2	ถนนเพชรบุรี	ถนนเพชรบุรี
ภาค 2	ถนนเพชรบุรี	ป้อมปราบ
ภาค 2	ถนนเพชรบุรี	มาบุญครอง
ภาค 2	ถนนเพชรบุรี	วรจักร
ภาค 2	ถนนเพชรบุรี	สยามพารากอน
ภาค 2	ถนนเพชรบุรี	อุรุพงษ์
ภาค 2	ถนนเพชรบุรี	เจริญผล
ภาค 2	ถนนเพชรบุรี	แพลทินัม
ภาค 2	บางรัก	ถนนจันทน์
ภาค 2	บางรัก	บางรัก
ภาค 2	บางรัก	สาทร
ภาค 2	บางรัก	สีลม
ภาค 2	บางรัก	หัวลำโพง
ภาค 2	บางรัก	เยาวราช
ภาค 2	บางรัก	แอทสาทร
ภาค 2	ปทุมวัน	ออล ซีซั่นส์ เพลส
ภาค 2	พระโขนง	คลองตัน
ภาค 2	พระโขนง	ซีคอนสแควร์
ภาค 2	พระโขนง	ธัญญาพาร์ค ศรีนครินทร์
ภาค 2	พระโขนง	บางนา
ภาค 2	พระโขนง	ปตท.ประเวศ
ภาค 2	พระโขนง	พระโขนง
ภาค 2	พระโขนง	พาราไดซ์ พาร์ค
ภาค 2	พระโขนง	รามคำแหง
ภาค 2	พระโขนง	รามคำแหง 2
ภาค 2	พระโขนง	หัวหมาก
ภาค 2	พระโขนง	เซ็นทรัล บางนา
ภาค 2	พระโขนง	เดอะซีน ทาวน์ อิน ทาวน์
ภาค 2	พระโขนง	เดอะไนน์ พระราม 9
ภาค 2	พระโขนง	ไบเทค บางนา
ภาค 2	พร้อมพงษ์	คลองเตย
ภาค 2	พร้อมพงษ์	จามจุรีสแควร์
ภาค 2	พร้อมพงษ์	ทองหล่อ
ภาค 2	พร้อมพงษ์	พร้อมพงษ์
ภาค 2	พร้อมพงษ์	ราชประสงค์
ภาค 2	พร้อมพงษ์	สามย่าน
ภาค 2	พร้อมพงษ์	ออล ซีซั่นส์ เพลส
ภาค 2	พร้อมพงษ์	เกทเวย์ เอกมัย
ภาค 2	พร้อมพงษ์	เซ็นทรัลเวิลด์
ภาค 2	พร้อมพงษ์	โลตัส พระราม 4
ภาค 2	มีนบุรี	บิ๊กซี สุวินทวงศ์
ภาค 2	มีนบุรี	บิ๊กซี หทัยราษฎร์
ภาค 2	มีนบุรี	บิ๊กซี เคหะร่มเกล้า
ภาค 2	มีนบุรี	มีนบุรี
ภาค 2	มีนบุรี	ลาดกระบัง
ภาค 2	มีนบุรี	หนองจอก
ภาค 2	มีนบุรี	เดอะพรอมานาด
ภาค 2	มีนบุรี	แฟชั่นไอส์แลนด์ 2
ภาค 2	มีนบุรี	ไอเพลส นิคมอุตสาหกรรมลาดกระบัง
ภาค 3	0	สำนักราชดำเนิน
ภาค 3	บางคอแหลม	ทรี ออน ธรี
ภาค 3	บางคอแหลม	ทุ่งมหาเมฆ
ภาค 3	บางคอแหลม	บางคอแหลม
ภาค 3	บางคอแหลม	บางโพงพาง
ภาค 3	บางคอแหลม	ศูนย์การค้ากรีนเพลส พลาซา
ภาค 3	บางคอแหลม	สมเด็จเจ้าพระยา
ภาค 3	บางคอแหลม	สาธุประดิษฐ์
ภาค 3	บางคอแหลม	อินท์ - อินเตอร์เซค
ภาค 3	บางคอแหลม	เจริญกรุง 107 (แฉล้มนิมิตร)
ภาค 3	บางคอแหลม	เจริญนคร
ภาค 3	บางคอแหลม	เซ็นทรัล พระราม 3
ภาค 3	บางคอแหลม	ไอคอนสยาม
ภาค 3	บางแค	ขนส่งสายใต้
ภาค 3	บางแค	จรัญสนิทวงศ์
ภาค 3	บางแค	ซีคอน บางแค
ภาค 3	บางแค	ตลาดพลู
ภาค 3	บางแค	ตลิ่งชัน
ภาค 3	บางแค	ท่าพระ
ภาค 3	บางแค	บางแค
ภาค 3	บางแค	สวนผัก
ภาค 3	บางแค	สี่แยกทศกัณฐ์
ภาค 3	บางแค	หนองแขม
ภาค 3	บางแค	หมู่บ้านเศรษฐกิจ
ภาค 3	บางแค	เดอะพาซิโอ พาร์ค กาญจนาภิเษก
ภาค 3	บางแค	เดอะมอลล์ บางแค
ภาค 3	ราษฎร์บูรณะ	ดาวคะนอง
ภาค 3	ราษฎร์บูรณะ	ถนนบางขุนเทียน - ชายทะเล
ภาค 3	ราษฎร์บูรณะ	ทุ่งครุ
ภาค 3	ราษฎร์บูรณะ	บางบอน (ตลาดปิ่นทอง)
ภาค 3	ราษฎร์บูรณะ	บิ๊กซี บางปะกอก
ภาค 3	ราษฎร์บูรณะ	บิ๊กซี พระราม 2
ภาค 3	ราษฎร์บูรณะ	พระราม 2 ซอย 64
ภาค 3	ราษฎร์บูรณะ	ราษฎร์บูรณะ
ภาค 3	ราษฎร์บูรณะ	วงเวียนใหญ่
ภาค 3	ราษฎร์บูรณะ	วัดไทร
ภาค 3	ราษฎร์บูรณะ	เซ็นทรัล พระราม 2
ภาค 3	ศิริราช	บางพลัด
ภาค 3	ศิริราช	บางลำภูบน
ภาค 3	ศิริราช	ปากคลองตลาด
ภาค 3	ศิริราช	มหาดไทย
ภาค 3	ศิริราช	ศิริราช
ภาค 3	ศิริราช	หน้าพระลาน
ภาค 3	ศิริราช	เจริญพาศน์
ภาค 3	ศิริราช	เซ็นทรัล ปิ่นเกล้า
ภาค 3	ศิริราช	เดอะมอลล์ ท่าพระ
ภาค 3	ศิริราช	เทเวศร์
ภาค 4	ประจวบคีรีขันธ์	กุยบุรี
ภาค 4	ประจวบคีรีขันธ์	ค่ายธนะรัชต์
ภาค 4	ประจวบคีรีขันธ์	ตลาดฉัตรไชย (หัวหิน)
ภาค 4	ประจวบคีรีขันธ์	ทับสะแก
ภาค 4	ประจวบคีรีขันธ์	บางสะพาน
ภาค 4	ประจวบคีรีขันธ์	บางสะพานน้อย
ภาค 4	ประจวบคีรีขันธ์	ประจวบคีรีขันธ์
ภาค 4	ประจวบคีรีขันธ์	ปราณบุรี
ภาค 4	ประจวบคีรีขันธ์	ปากน้ำปราณ
ภาค 4	ประจวบคีรีขันธ์	สามร้อยยอด
ภาค 4	ประจวบคีรีขันธ์	หัวหิน
ภาค 4	ราชบุรี	จอมบึง
ภาค 4	ราชบุรี	ดำเนินสะดวก
ภาค 4	ราชบุรี	บางแพ
ภาค 4	ราชบุรี	บ้านโป่ง
ภาค 4	ราชบุรี	รอยัลพาร์ค
ภาค 4	ราชบุรี	ราชบุรี
ภาค 4	ราชบุรี	วัดเพลง
ภาค 4	ราชบุรี	สวนผึ้ง
ภาค 4	ราชบุรี	โพธาราม
ภาค 4	สมุทรสาคร	กระทุ่มแบน
ภาค 4	สมุทรสาคร	ถนนเศรษฐกิจ 1
ภาค 4	สมุทรสาคร	บางคนที
ภาค 4	สมุทรสาคร	บ้านแพ้ว
ภาค 4	สมุทรสาคร	พันท้ายนรสิงห์
ภาค 4	สมุทรสาคร	มหาชัย
ภาค 4	สมุทรสาคร	สมุทรสงคราม
ภาค 4	สมุทรสาคร	สมุทรสาคร
ภาค 4	สมุทรสาคร	อัมพวา
ภาค 4	สมุทรสาคร	เซ็นทรัล มหาชัย
ภาค 4	สมุทรสาคร	เพชรสมุทร
ภาค 4	สมุทรสาคร	โพธิ์แจ้
ภาค 4	เพชรบุรี	ชะอำ
ภาค 4	เพชรบุรี	ท่ายาง
ภาค 4	เพชรบุรี	บ้านลาด
ภาค 4	เพชรบุรี	บ้านแหลม
ภาค 4	เพชรบุรี	มหาวิทยาลัยราชภัฎเพชรบุรี
ภาค 4	เพชรบุรี	สะพานจอมเกล้า
ภาค 4	เพชรบุรี	หนองหญ้าปล้อง
ภาค 4	เพชรบุรี	เขาย้อย
ภาค 4	เพชรบุรี	เพชรบุรี
ภาค 4	เพชรบุรี	แก่งกระจาน
ภาค 4	เพชรบุรี	โรบินสัน เพชรบุรี
ภาค 5	กาญจนบุรี	กาญจนบุรี
ภาค 5	กาญจนบุรี	ด่านมะขามเตี้ย
ภาค 5	กาญจนบุรี	ตลาดผาสุก
ภาค 5	กาญจนบุรี	ทองผาภูมิ
ภาค 5	กาญจนบุรี	ท่ามะกา
ภาค 5	กาญจนบุรี	ท่าม่วง
ภาค 5	กาญจนบุรี	ท่าเรือ (กาญจนบุรี)
ภาค 5	กาญจนบุรี	บ่อพลอย
ภาค 5	กาญจนบุรี	พนมทวน
ภาค 5	กาญจนบุรี	ลาดหญ้า
ภาค 5	กาญจนบุรี	ลูกแก
ภาค 5	กาญจนบุรี	ห้วยกระเจา
ภาค 5	นครปฐม	กำแพงแสน
ภาค 5	นครปฐม	ดอนหวาย
ภาค 5	นครปฐม	นครชัยศรี
ภาค 5	นครปฐม	นครปฐม
ภาค 5	นครปฐม	บางเลน
ภาค 5	นครปฐม	บิ๊กซี อ้อมใหญ่
ภาค 5	นครปฐม	พุทธมณฑลสาย 4
ภาค 5	นครปฐม	ศาลายา
ภาค 5	นครปฐม	สนามจันทร์
ภาค 5	นครปฐม	อ้อมใหญ่
ภาค 5	นครปฐม	เซ็นทรัล ศาลายา
ภาค 5	นครปฐม	โฮมโปร นครปฐม
ภาค 5	นนทบุรี 1	ตลาดรวมใจ (เมืองทองธานี)
ภาค 5	นนทบุรี 1	ติวานนท์
ภาค 5	นนทบุรี 1	ท่าน้ำนนทบุรี
ภาค 5	นนทบุรี 1	นนทบุรี
ภาค 5	นนทบุรี 1	ปากเกร็ด
ภาค 5	นนทบุรี 1	สัมมากร เพลส ราชพฤกษ์
ภาค 5	นนทบุรี 1	เซ็นทรัล รัตนาธิเบศร์
ภาค 5	นนทบุรี 1	เซ็นทรัล แจ้งวัฒนะ
ภาค 5	นนทบุรี 1	เดอะมอลล์ งามวงศ์วาน
ภาค 5	นนทบุรี 1	เมืองทองธานี
ภาค 5	นนทบุรี 1	แคราย
ภาค 5	นนทบุรี 2	การไฟฟ้าฝ่ายผลิตบางกรวย
ภาค 5	นนทบุรี 2	ตลาดเจ้าพระยา
ภาค 5	นนทบุรี 2	บัวทองสแควร์
ภาค 5	นนทบุรี 2	บางกรวย
ภาค 5	นนทบุรี 2	บางบัวทอง
ภาค 5	นนทบุรี 2	บางใหญ่
ภาค 5	นนทบุรี 2	อินเด็กซ์ บางใหญ่
ภาค 5	นนทบุรี 2	เซ็นทรัล เวสต์เกต
ภาค 5	นนทบุรี 2	เดอะคริสตัล ราชพฤกษ์
ภาค 5	นนทบุรี 2	ไทรน้อย
ภาค 5	นนทบุรี 2	ไทรใหญ่
ภาค 5	สุพรรณบุรี	ดอนเจดีย์
ภาค 5	สุพรรณบุรี	ด่านช้าง
ภาค 5	สุพรรณบุรี	ถนนนางพิม
ภาค 5	สุพรรณบุรี	ทุ่งคอก
ภาค 5	สุพรรณบุรี	บางปลาม้า
ภาค 5	สุพรรณบุรี	ศรีประจันต์
ภาค 5	สุพรรณบุรี	สองพี่น้อง
ภาค 5	สุพรรณบุรี	สามชุก
ภาค 5	สุพรรณบุรี	สุพรรณบุรี
ภาค 5	สุพรรณบุรี	หนองหญ้าไซ
ภาค 5	สุพรรณบุรี	อู่ทอง
ภาค 5	สุพรรณบุรี	เดิมบางนางบวช
ภาค 5	สุพรรณบุรี	โรบินสัน สุพรรณบุรี
ภาค 6	นครสวรรค์	ชุมตาบง
ภาค 6	นครสวรรค์	ชุมแสง
ภาค 6	นครสวรรค์	ตลาดศรีนคร
ภาค 6	นครสวรรค์	ตากฟ้า
ภาค 6	นครสวรรค์	ตาคลี
ภาค 6	นครสวรรค์	ท่าตะโก
ภาค 6	นครสวรรค์	นครสวรรค์
ภาค 6	นครสวรรค์	บรรพตพิสัย
ภาค 6	นครสวรรค์	บิ๊กซี (วี - สแควร์) นครสวรรค์
ภาค 6	นครสวรรค์	พยุหะคีรี
ภาค 6	นครสวรรค์	ลาดยาว
ภาค 6	นครสวรรค์	สวรรค์วิถี
ภาค 6	นครสวรรค์	หนองบัว
ภาค 6	นครสวรรค์	หนองปลิง
ภาค 6	นครสวรรค์	หนองเบน
ภาค 6	นครสวรรค์	โกรกพระ
ภาค 6	นครสวรรค์	ไพศาลี
ภาค 6	พิจิตร	ตะพานหิน
ภาค 6	พิจิตร	ทับคล้อ
ภาค 6	พิจิตร	บางมูลนาก
ภาค 6	พิจิตร	พิจิตร
ภาค 6	พิจิตร	ราชรถ
ภาค 6	พิจิตร	สากเหล็ก
ภาค 6	พิจิตร	สามง่าม
ภาค 6	พิจิตร	โพทะเล
ภาค 6	ลพบุรี	ท่าวุ้ง
ภาค 6	ลพบุรี	บิ๊กซี ลพบุรี 1
ภาค 6	ลพบุรี	บ้านหมี่
ภาค 6	ลพบุรี	พัฒนานิคม
ภาค 6	ลพบุรี	ลพบุรี
ภาค 6	ลพบุรี	ลำนารายณ์
ภาค 6	ลพบุรี	วงเวียนสระแก้ว
ภาค 6	ลพบุรี	หนองม่วง
ภาค 6	ลพบุรี	โคกกะเทียม
ภาค 6	ลพบุรี	โคกสำโรง
ภาค 6	ลพบุรี	โรบินสัน ลพบุรี
ภาค 6	อุทัยธานี	ชัยนาท
ภาค 6	อุทัยธานี	บ้านไร่
ภาค 6	อุทัยธานี	มโนรมย์
ภาค 6	อุทัยธานี	ลานสัก
ภาค 6	อุทัยธานี	วัดสิงห์
ภาค 6	อุทัยธานี	สรรคบุรี
ภาค 6	อุทัยธานี	สรรพยา
ภาค 6	อุทัยธานี	สะพานใหม่ ชัยนาท
ภาค 6	อุทัยธานี	หนองฉาง
ภาค 6	อุทัยธานี	หันคา
ภาค 6	อุทัยธานี	อุทัยธานี
ภาค 6	เพชรบูรณ์	ชนแดน
ภาค 6	เพชรบูรณ์	ซับสมอทอด
ภาค 6	เพชรบูรณ์	ตลาดท่าพล
ภาค 6	เพชรบูรณ์	ตลาดพุเตย
ภาค 6	เพชรบูรณ์	บิ๊กซี หล่มสัก
ภาค 6	เพชรบูรณ์	วิเชียรบุรี
ภาค 6	เพชรบูรณ์	ศรีเทพ
ภาค 6	เพชรบูรณ์	หนองไผ่
ภาค 6	เพชรบูรณ์	หล่มสัก
ภาค 6	เพชรบูรณ์	หล่มเก่า
ภาค 6	เพชรบูรณ์	เพชรบูรณ์
ภาค 6	เพชรบูรณ์	โลตัส เพชรบูรณ์
ภาค 7	กำแพงเพชร	กำแพงเพชร
ภาค 7	กำแพงเพชร	ขาณุวรลักษบุรี
ภาค 7	กำแพงเพชร	คลองขลุง
ภาค 7	กำแพงเพชร	คลองลาน
ภาค 7	กำแพงเพชร	นครชุม
ภาค 7	กำแพงเพชร	บิ๊กซี กำแพงเพชร
ภาค 7	กำแพงเพชร	พรานกระต่าย
ภาค 7	กำแพงเพชร	ลานกระบือ
ภาค 7	กำแพงเพชร	สลกบาตร
ภาค 7	ตาก	ตลาดพาเจริญ
ภาค 7	ตาก	ตาก
ภาค 7	ตาก	ท่าสองยาง
ภาค 7	ตาก	บิ๊กซี ตาก
ภาค 7	ตาก	บ้านตาก
ภาค 7	ตาก	พบพระ
ภาค 7	ตาก	อุ้มผาง
ภาค 7	ตาก	แม่ระมาด
ภาค 7	ตาก	แม่สอด
ภาค 7	ตาก	โรบินสัน แม่สอด
ภาค 7	พิษณุโลก 1	ท่ามะปราง
ภาค 7	พิษณุโลก 1	นางพญา
ภาค 7	พิษณุโลก 1	บางระกำ
ภาค 7	พิษณุโลก 1	บิ๊กซี พิษณุโลก
ภาค 7	พิษณุโลก 1	พิษณุโลก
ภาค 7	พิษณุโลก 1	มิตรภาพ
ภาค 7	พิษณุโลก 1	ห้าแยกโคกมะตูม
ภาค 7	พิษณุโลก 1	เซ็นทรัล พิษณุโลก
ภาค 7	พิษณุโลก 1	โลตัส พิษณุโลก ท่าทอง
ภาค 7	พิษณุโลก 2	ชาติตระการ
ภาค 7	พิษณุโลก 2	ทรัพย์ไพรวัลย์
ภาค 7	พิษณุโลก 2	นครไทย
ภาค 7	พิษณุโลก 2	บางกระทุ่ม
ภาค 7	พิษณุโลก 2	พรหมพิราม
ภาค 7	พิษณุโลก 2	วังทอง
ภาค 7	พิษณุโลก 2	วัดโบสถ์
ภาค 7	พิษณุโลก 2	หนองตม
ภาค 7	พิษณุโลก 2	เนินมะปราง
ภาค 7	สุโขทัย	กงไกรลาศ
ภาค 7	สุโขทัย	คีรีมาศ
ภาค 7	สุโขทัย	ทุ่งเสลี่ยม
ภาค 7	สุโขทัย	บิ๊กซี สุโขทัย
ภาค 7	สุโขทัย	บ้านด่านลานหอย
ภาค 7	สุโขทัย	ศรีนคร
ภาค 7	สุโขทัย	ศรีสัชนาลัย
ภาค 7	สุโขทัย	ศรีสำโรง
ภาค 7	สุโขทัย	สวรรคโลก
ภาค 7	สุโขทัย	สุโขทัย
ภาค 7	อุตรดิตถ์	คลองโพ
ภาค 7	อุตรดิตถ์	ตรอน
ภาค 7	อุตรดิตถ์	ทองแสนขัน
ภาค 7	อุตรดิตถ์	ท่าปลา
ภาค 7	อุตรดิตถ์	น้ำปาด
ภาค 7	อุตรดิตถ์	พิชัย
ภาค 7	อุตรดิตถ์	ฟากท่า
ภาค 7	อุตรดิตถ์	มุขศาลา
ภาค 7	อุตรดิตถ์	ลับแล
ภาค 7	อุตรดิตถ์	อุตรดิตถ์
ภาค 8	ลำพูน	กาดลำพูนจตุจักร
ภาค 8	ลำพูน	ขุนยวม
ภาค 8	ลำพูน	นิคมอุตสาหกรรมลำพูน
ภาค 8	ลำพูน	บิ๊กซี ลำพูน
ภาค 8	ลำพูน	บ้านโฮ่ง
ภาค 8	ลำพูน	ปาย
ภาค 8	ลำพูน	แม่ลาน้อย
ภาค 8	ลำพูน	แม่ฮ่องสอน
ภาค 8	เชียงใหม่ 1	ช้างคลาน
ภาค 8	เชียงใหม่ 1	ช้างม่อย
ภาค 8	เชียงใหม่ 1	ถนนทิพย์เนตร
ภาค 8	เชียงใหม่ 1	บิ๊กซี เชียงใหม่ (ดอนจั่น)
ภาค 8	เชียงใหม่ 1	ประตูช้างเผือก
ภาค 8	เชียงใหม่ 1	สามแยกสันทราย
ภาค 8	เชียงใหม่ 1	หนองหอย
ภาค 8	เชียงใหม่ 1	เชียงใหม่
ภาค 8	เชียงใหม่ 1	เซ็นทรัล เชียงใหม่
ภาค 8	เชียงใหม่ 1	เซ็นทรัล เชียงใหม่ แอร์พอร์ต
ภาค 8	เชียงใหม่ 2	ดอยสะเก็ด
ภาค 8	เชียงใหม่ 2	ฝาง
ภาค 8	เชียงใหม่ 2	พร้าว
ภาค 8	เชียงใหม่ 2	สันทราย
ภาค 8	เชียงใหม่ 2	เวียงแหง
ภาค 8	เชียงใหม่ 2	แม่ริม
ภาค 8	เชียงใหม่ 2	แม่อาย
ภาค 8	เชียงใหม่ 2	แม่แตง
ภาค 8	เชียงใหม่ 2	แม่โจ้
ภาค 8	เชียงใหม่ 2	ไชยปราการ
ภาค 8	เชียงใหม่ 3	ดอยเต่า
ภาค 8	เชียงใหม่ 3	บวกครกหลวง
ภาค 8	เชียงใหม่ 3	บิ๊กซี หางดง
ภาค 8	เชียงใหม่ 3	บ่อสร้าง
ภาค 8	เชียงใหม่ 3	สันกำแพง
ภาค 8	เชียงใหม่ 3	สารภี
ภาค 8	เชียงใหม่ 3	หางดง
ภาค 8	เชียงใหม่ 3	ฮอด
ภาค 8	เชียงใหม่ 3	แม่วาง
ภาค 9	น่าน	ทุ่งช้าง
ภาค 9	น่าน	ท่าวังผา
ภาค 9	น่าน	นาน้อย
ภาค 9	น่าน	น่าน
ภาค 9	น่าน	ปัว
ภาค 9	น่าน	สองแคว
ภาค 9	น่าน	ห้างนราไฮเปอร์มาร์ท
ภาค 9	น่าน	เฉลิมพระเกียรติ
ภาค 9	น่าน	เชียงกลาง
ภาค 9	น่าน	เวียงสา
ภาค 9	น่าน	แม่จริม
ภาค 9	พะเยา	จุน
ภาค 9	พะเยา	ดอกคำใต้
ภาค 9	พะเยา	ท็อปส์ พลาซ่า พะเยา
ภาค 9	พะเยา	ปง
ภาค 9	พะเยา	พะเยา
ภาค 9	พะเยา	มหาวิทยาลัยพะเยา
ภาค 9	พะเยา	เชียงคำ
ภาค 9	พะเยา	แม่ใจ
ภาค 9	ลำปาง	งาว
ภาค 9	ลำปาง	วังเหนือ
ภาค 9	ลำปาง	สบตุ๋ย
ภาค 9	ลำปาง	ห้างฉัตร
ภาค 9	ลำปาง	เกาะคา
ภาค 9	ลำปาง	เซ็นทรัล ลำปาง
ภาค 9	ลำปาง	เถิน
ภาค 9	ลำปาง	แม่ทะ
ภาค 9	ลำปาง	แม่เมาะ
ภาค 9	เชียงราย	กลางเวียง
ภาค 9	เชียงราย	ขุนตาล
ภาค 9	เชียงราย	บ้านดู่
ภาค 9	เชียงราย	พาน
ภาค 9	เชียงราย	มหาวิทยาลัยแม่ฟ้าหลวง
ภาค 9	เชียงราย	ร่องขุ่น
ภาค 9	เชียงราย	เชียงราย
ภาค 9	เชียงราย	เชียงแสน
ภาค 9	เชียงราย	เซ็นทรัล เชียงราย
ภาค 9	เชียงราย	เทิง
ภาค 9	เชียงราย	เวียงป่าเป้า
ภาค 9	เชียงราย	เวียงเชียงรุ้ง
ภาค 9	เชียงราย	แม่ขะจาน
ภาค 9	เชียงราย	แม่สรวย
ภาค 9	เชียงราย	แม่สาย
ภาค 9	แพร่	กาดน้ำทอง แพร่
ภาค 9	แพร่	ทุ่งโฮ้ง
ภาค 9	แพร่	ร้องกวาง
ภาค 9	แพร่	ลอง
ภาค 9	แพร่	วังชิ้น
ภาค 9	แพร่	สอง
ภาค 9	แพร่	สูงเม่น
ภาค 9	แพร่	เด่นชัย
ภาค 9	แพร่	แพร่
		
		
`.trim();

/* -------------------------- 2) ตัวช่วย parse และ index -------------------------- */

type BranchIndex = {
  regions: string[];
  districtsByRegion: Record<string, string[]>;
  branchesByKey: Record<string, string[]>;
};

function parseBranchCSV(text: string): Array<[string, string, string]> {
  if (!text) return [];
  const lines = text
    .split(/\r?\n/)
    .map((l) => l.trim())
    .filter(Boolean);

  if (lines.length <= 1) return [];

  const sep = lines[0].includes("\t") ? "\t" : ",";
  const rows: Array<[string, string, string]> = [];

  for (let i = 1; i < lines.length; i++) {
    const raw = lines[i].split(sep).map((s) => s.trim());
    if (raw.length < 3) continue;
    const [region, district, branch] = raw;
    if (!region || !district || !branch) continue;
    rows.push([region, district, branch]);
  }
  return rows;
}

function buildBranchIndex(rows: Array<[string, string, string]>): BranchIndex {
  const regionSet = new Set<string>();
  const districtsByRegion: Record<string, Set<string>> = {};
  const branchesByKey: Record<string, Set<string>> = {};

  for (const [r, d, b] of rows) {
    regionSet.add(r);
    if (!districtsByRegion[r]) districtsByRegion[r] = new Set<string>();
    districtsByRegion[r].add(d);

    const key = `${r}||${d}`;
    if (!branchesByKey[key]) branchesByKey[key] = new Set<string>();
    branchesByKey[key].add(b);
  }

  return {
    regions: Array.from(regionSet).sort(),
    districtsByRegion: Object.fromEntries(
      Object.entries(districtsByRegion).map(([r, set]) => [r, Array.from(set).sort()])
    ),
    branchesByKey: Object.fromEntries(
      Object.entries(branchesByKey).map(([k, set]) => [k, Array.from(set).sort()])
    ),
  };
}

/* ----------------------------- Category maps ----------------------------- */
const HEAD_CATEGORIES = [
  { value: "all", label: "ทั้งหมด" },
  { value: "1", label: "1. พนักงานและบุคลากร" },
  { value: "2", label: "2. ระบบและกระบวนการให้บริการ" },
  { value: "3", label: "3. เทคโนโลยีและดิจิทัล" },
  { value: "4", label: "4. เงื่อนไขและผลิตภัณฑ์" },
  { value: "5", label: "5. สภาพแวดล้อมและสิ่งอำนวยความสะดวก" },
  { value: "6", label: "6. Market Conduct" },
  { value: "7", label: "7. อื่นๆ" },
] as const;

const SUBCATS: Record<string, Array<{ code: string; label: string }>> = {
  "1": [
    { code: "1.1", label: "ความสุภาพและมารยาทของพนักงาน" },
    { code: "1.2", label: "ความเอาใจใส่ในการให้บริการลูกค้า" },
    { code: "1.3", label: "ความสามารถในการตอบคำถามหรือให้คำแนะนำ" },
    { code: "1.4", label: "ความถูกต้องในการให้บริการ" },
    { code: "1.5", label: "ความรวดเร็วในการให้บริการ" },
    { code: "1.6", label: "ความเป็นมืออาชีพและการแก้ไขปัญหาเฉพาะหน้า" },
    { code: "1.7", label: "ความประทับใจในการให้บริการ" },
    { code: "1.8", label: "รปภ, แม่บ้าน" },
  ],
  "2": [
    { code: "2.1", label: "ความพร้อมในการให้บริการ" },
    { code: "2.2", label: "กระบวนการให้บริการ ความเป็นธรรมให้บริการ" },
    { code: "2.3", label: "ระบบเรียกคิวและจัดการคิว" },
    { code: "2.4", label: "ภาระเอกสาร" },
  ],
  "3": [
    { code: "3.1", label: "ระบบ Core ของธนาคาร" },
    { code: "3.2", label: "เครื่องออกบัตรคิว" },
    { code: "3.3", label: "ATM ADM CDM" },
    { code: "3.4", label: "E-KYC Scanner" },
    { code: "3.5", label: "แอพพลิเคชัน MyMo" },
    { code: "3.6", label: "เครื่องปรับสมุด" },
    { code: "3.7", label: "เครื่องนับเงิน" },
  ],
  "4": [
    { code: "4.1", label: "รายละเอียดผลิตภัณฑ์" },
    { code: "4.2", label: "เงื่อนไขอนุมัติ" },
    { code: "4.3", label: "ระยะเวลาอนุมัติ" },
    { code: "4.4", label: "ความยืดหยุ่น" },
    { code: "4.5", label: "ความเรียบง่ายข้อมูล" },
  ],
  "5": [
    { code: "5.1", label: "ความสะอาด" },
    { code: "5.2", label: "พื้นที่และความคับคั่ง" },
    { code: "5.3", label: "อุณหภูมิ" },
    { code: "5.4", label: "โต๊ะรับบริการ" },
    { code: "5.5", label: "จุดรอรับบริการ" },
    { code: "5.6", label: "แสง" },
    { code: "5.7", label: "เสียง" },
    { code: "5.8", label: "ห้องน้ำ" },
    { code: "5.9", label: "ที่จอดรถ" },
    { code: "5.10", label: "ป้าย-สื่อประชาสัมพันธ์" },
    { code: "5.11", label: "สิ่งอำนวยความสะดวกอื่นๆ" },
  ],
  "6": [
    { code: "6.1", label: "ไม่หลอกลวง" },
    { code: "6.2", label: "ไม่เอาเปรียบ" },
    { code: "6.3", label: "ไม่บังคับ" },
    { code: "6.4", label: "ไม่รบกวน" },
  ],
  "7": [{ code: "7.1", label: "ความประทับใจอื่นๆ" }],
};

const LEGACY_KEY_TO_CODE: Record<string, string> = {
  // staff
  staffPoliteness: "1.1",
  staffCare: "1.2",
  staffConsultation: "1.3",
  staffAccuracy: "1.4",
  staffSpeed: "1.5",
  staffProfessionalism: "1.6",
  staffImpression: "1.7",
  staffSecurity: "1.8",
  // service
  serviceReadiness: "2.1",
  serviceProcess: "2.2",
  serviceQueue: "2.3",
  serviceDocuments: "2.4",
  // tech
  techCore: "3.1",
  techQueue: "3.2",
  techATM: "3.3",
  techKYC: "3.4",
  techApp: "3.5",
  techBookUpdate: "3.6",
  techCashCounter: "3.7",
  // products
  productDetails: "4.1",
  productConditions: "4.2",
  productApprovalTime: "4.3",
  productFlexibility: "4.4",
  productSimplicity: "4.5",
  // environment
  envCleanliness: "5.1",
  envSpace: "5.2",
  envTemperature: "5.3",
  envDesk: "5.4",
  envWaitingArea: "5.5",
  envLighting: "5.6",
  envSound: "5.7",
  envRestroom: "5.8",
  envParking: "5.9",
  envSignage: "5.10",
  envOtherFacilities: "5.11",
  // conduct
  conductNoDeception: "6.1",
  conductNoAdvantage: "6.2",
  conductNoForcing: "6.3",
  conductNoDisturbance: "6.4",
  // other
  otherImpression: "7.1",
};

const LABEL_BY_CODE = Object.fromEntries(
  Object.values(SUBCATS).flat().map((x) => [x.code, x.label])
);

/* ------------------------------ Helper utils ----------------------------- */
function pickTagCodes(f: FeedbackEntry): string[] {
  const detailed = (f as any).detailedSentiment as Record<string, number> | undefined;
  if (!detailed) return [];
  const codes: string[] = [];
  for (const [k, v] of Object.entries(detailed)) {
    if (v === -1 && LEGACY_KEY_TO_CODE[k]) codes.push(LEGACY_KEY_TO_CODE[k]);
  }
  return Array.from(new Set(codes));
}

const serviceTypeOptions = [
  "ทั้งหมด",
  "การฝากเงิน/ถอนเงิน",
  "การซื้อผลิตภัณฑ์",
  "การชำระค่าบริการ/ค่าธรรมเนียม",
  "อื่นๆ",
];

type TimeType = "all" | "monthly" | "back" | "custom";
const backRanges = [
  { value: "7d", label: "7 วัน", ms: 7 * 24 * 60 * 60 * 1000 },
  { value: "14d", label: "14 วัน", ms: 14 * 24 * 60 * 60 * 1000 },
  { value: "1m", label: "1 เดือน", ms: 30 * 24 * 60 * 60 * 1000 },
  { value: "3m", label: "3 เดือน", ms: 90 * 24 * 60 * 60 * 1000 },
  { value: "6m", label: "6 เดือน", ms: 180 * 24 * 60 * 60 * 1000 },
  { value: "1y", label: "1 ปี", ms: 365 * 24 * 60 * 60 * 1000 },
];

/* --------------------------------- Page ---------------------------------- */
export default function ComplaintsPage() {
  /* ---------- โหลด “ภาค/เขต/สาขา” จากข้อความ CSV/TSV และสร้างดัชนี ---------- */
  const branchIndex = useMemo(() => {
    const rows = parseBranchCSV(CSV_TEXT);
    return buildBranchIndex(rows);
  }, []);

  /* ---------------------------- header dropdowns ---------------------------- */
  // พื้นที่ (อิงจาก CSV/TSV)
  const [region, setRegion] = useState("ทั้งหมด");
  const regionOptions = useMemo(() => ["ทั้งหมด", ...branchIndex.regions], [branchIndex]);

  const [district, setDistrict] = useState("ทั้งหมด");
  const districtOptions = useMemo(() => {
    if (region === "ทั้งหมด") return ["ทั้งหมด"];
    return ["ทั้งหมด", ...(branchIndex.districtsByRegion[region] ?? [])];
  }, [region, branchIndex]);

  const [branch, setBranch] = useState("ทั้งหมด");
  const branchOptions = useMemo(() => {
    if (region === "ทั้งหมด" || district === "ทั้งหมด") return ["ทั้งหมด"];
    const key = `${region}||${district}`;
    return ["ทั้งหมด", ...(branchIndex.branchesByKey[key] ?? [])];
  }, [region, district, branchIndex]);

  // เวลา
  const [timeType, setTimeType] = useState<TimeType>("all");
  const [monthKey, setMonthKey] = useState<string>(""); // YYYY-MM
  const [backKey, setBackKey] = useState<string>("1m");
  const [startDate, setStartDate] = useState<string>("");
  const [endDate, setEndDate] = useState<string>("");

  // ประเภท/ทัศนคติ
  const [serviceType, setServiceType] = useState("ทั้งหมด");
  const [sentiment, setSentiment] = useState<"all" | "positive" | "negative">("all");

  // หมวด
  const [headCat, setHeadCat] = useState<(typeof HEAD_CATEGORIES)[number]["value"]>("all");
  const subcatList = useMemo(
    () => (headCat === "all" ? [] : SUBCATS[headCat] ?? []),
    [headCat]
  );
  const [subCat, setSubCat] = useState<string>("all");

  /* --------------------------------- time --------------------------------- */
  const monthOptions = useMemo(() => {
    const today = new Date();
    const list: { key: string; label: string }[] = [];
    for (let i = 0; i < 18; i++) {
      const d = new Date(today.getFullYear(), today.getMonth() - i, 1);
      const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}`;
      const th = d.toLocaleDateString("th-TH", { year: "2-digit", month: "long" });
      list.push({ key, label: th });
    }
    return list;
  }, []);

  function inTimeRange(dateStr: string): boolean {
    if (timeType === "all") return true;
    const d = parseDate(dateStr);
    if (!d) return true;

    if (timeType === "monthly" && monthKey) {
      const [y, m] = monthKey.split("-").map((x) => parseInt(x, 10));
      const start = new Date(y, m - 1, 1).getTime();
      const end = new Date(y, m, 0, 23, 59, 59, 999).getTime();
      return d.getTime() >= start && d.getTime() <= end;
    }
    if (timeType === "back") {
      const item = backRanges.find((x) => x.value === backKey) ?? backRanges[2];
      const start = Date.now() - item.ms;
      return d.getTime() >= start;
    }
    if (timeType === "custom" && startDate && endDate) {
      const s = parseDate(startDate)?.getTime() ?? 0;
      const e = parseDate(endDate)?.getTime() ?? Date.now();
      return d.getTime() >= s && d.getTime() <= e;
    }
    return true;
  }

  function parseDate(s: string): Date | null {
    if (!s) return null;
    if (s.includes("-")) return new Date(s); // yyyy-mm-dd
    if (s.includes("/")) {
      const [dd, mm, yyyy] = s.split("/");
      return new Date(parseInt(yyyy, 10), parseInt(mm, 10) - 1, parseInt(dd, 10));
    }
    return new Date(s);
  }

  /* --------- ป้องกัน “ศูนย์รายการ” เพราะเขต/สาขาใน mock ไม่ตรง CSV --------- */
  const availableDistricts = useMemo(
    () => new Set(mockFeedbackData.map((f) => f.branch.district)),
    []
  );
  const availableBranches = useMemo(
    () => new Set(mockFeedbackData.map((f) => f.branch.branch)),
    []
  );

  /* ------------------------------- filtering ------------------------------- */
  const filtered = useMemo(() => {
    return mockFeedbackData
      .filter((f) => {
        if (region !== "ทั้งหมด" && f.branch.region !== region) return false;

        if (
          district !== "ทั้งหมด" &&
          availableDistricts.has(district) &&
          f.branch.district !== district
        ) {
          return false;
        }

        if (
          branch !== "ทั้งหมด" &&
          availableBranches.has(branch) &&
          f.branch.branch !== branch
        ) {
          return false;
        }

        if (serviceType !== "ทั้งหมด" && f.serviceType !== serviceType) return false;

        if (sentiment !== "all") {
          const list = Object.values(f.sentiment);
          const hasPos = list.some((v) => v === 1);
          const hasNeg = list.some((v) => v === -1);
          if (sentiment === "positive" && !hasPos) return false;
          if (sentiment === "negative" && !hasNeg) return false;
        }

        if (!inTimeRange(f.date)) return false;

        if (headCat !== "all") {
          const codes = pickTagCodes(f);
          if (!codes.some((c) => c.startsWith(headCat + "."))) return false;
          if (subCat !== "all" && !codes.includes(subCat)) return false;
        }

        return true;
      })
      .sort(
        (a, b) => (parseDate(b.date)?.getTime() ?? 0) - (parseDate(a.date)?.getTime() ?? 0)
      );
  }, [
    region,
    district,
    branch,
    serviceType,
    sentiment,
    timeType,
    monthKey,
    backKey,
    startDate,
    endDate,
    headCat,
    subCat,
    availableDistricts,
    availableBranches,
  ]);

  function resetAll() {
    setRegion("ทั้งหมด");
    setDistrict("ทั้งหมด");
    setBranch("ทั้งหมด");
    setTimeType("all");
    setMonthKey("");
    setBackKey("1m");
    setStartDate("");
    setEndDate("");
    setServiceType("ทั้งหมด");
    setSentiment("all");
    setHeadCat("all");
    setSubCat("all");
  }

  /* --------------------------------- UI ---------------------------------- */
  return (
    <div className="space-y-6">
      {/* Page heading */}
      <div>
        <h1 className="text-3xl font-bold text-foreground">ข้อร้องเรียนลูกค้า</h1>
        <p className="text-muted-foreground">ระบบสรุปข้อร้องเรียนสำคัญจากลูกค้า</p>
      </div>

      {/* Filters box */}
      <Card>
        <CardHeader className="flex flex-row items-center justify-between space-y-0">
          <CardTitle className="text-xl">ตัวกรองการแสดงผล</CardTitle>
          <div className="space-x-2">
            <Button variant="outline" onClick={resetAll}>
              ล้างตัวกรอง
            </Button>
          </div>
        </CardHeader>

        <CardContent className="space-y-6">
          {/* พื้นที่ให้บริการ */}
          <section>
            <div className="mb-3 text-lg font-semibold">พื้นที่ให้บริการ</div>
            <div className="grid grid-cols-1 gap-4 md:grid-cols-3">
              {/* Region */}
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">ภาค</label>
                <Select
                  value={region}
                  onValueChange={(v) => {
                    setRegion(v);
                    setDistrict("ทั้งหมด");
                    setBranch("ทั้งหมด");
                  }}
                >
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกภาค" />
                  </SelectTrigger>
                  <SelectContent>
                    {regionOptions.map((r) => (
                      <SelectItem key={r} value={r}>
                        {r}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>

              {/* District */}
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">เขต</label>
                <Select
                  value={district}
                  onValueChange={(v) => {
                    setDistrict(v);
                    setBranch("ทั้งหมด");
                  }}
                  disabled={region === "ทั้งหมด"}
                >
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกเขต" />
                  </SelectTrigger>
                  <SelectContent>
                    {districtOptions.map((d) => (
                      <SelectItem key={d} value={d}>
                        {d}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>

              {/* Branch */}
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">สาขา</label>
                <Select
                  value={branch}
                  onValueChange={setBranch}
                  disabled={region === "ทั้งหมด" || district === "ทั้งหมด"}
                >
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกสาขา" />
                  </SelectTrigger>
                  <SelectContent>
                    {branchOptions.map((b) => (
                      <SelectItem key={b} value={b}>
                        {b}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>
            </div>
          </section>

          {/* ช่วงเวลาเก็บแบบประเมิน */}
          <section>
            <div className="mb-3 text-lg font-semibold">ช่วงเวลาการประเมิน</div>
            <div className="grid grid-cols-1 gap-4 md:grid-cols-3">
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">ประเภท</label>
                <Select value={timeType} onValueChange={(v: TimeType) => setTimeType(v)}>
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกประเภทเวลา" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">ทั้งหมด</SelectItem>
                    <SelectItem value="monthly">รายเดือน</SelectItem>
                    <SelectItem value="back">ช่วงเวลาย้อนหลัง</SelectItem>
                    <SelectItem value="custom">กำหนดเอง</SelectItem>
                  </SelectContent>
                </Select>
              </div>

              {timeType === "monthly" && (
                <div className="space-y-2">
                  <label className="text-sm text-muted-foreground">เดือน</label>
                  <Select value={monthKey} onValueChange={setMonthKey}>
                    <SelectTrigger>
                      <SelectValue placeholder="เลือกเดือน" />
                    </SelectTrigger>
                    <SelectContent>
                      {monthOptions.map((m) => (
                        <SelectItem key={m.key} value={m.key}>
                          {m.label}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>
              )}

              {timeType === "back" && (
                <div className="space-y-2">
                  <label className="text-sm text-muted-foreground">ย้อนหลัง</label>
                  <Select value={backKey} onValueChange={setBackKey}>
                    <SelectTrigger>
                      <SelectValue placeholder="เลือกช่วงเวลา" />
                    </SelectTrigger>
                    <SelectContent>
                      {backRanges.map((r) => (
                        <SelectItem key={r.value} value={r.value}>
                          {r.label}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>
              )}

              {timeType === "custom" && (
                <>
                  <div className="space-y-2">
                    <label className="text-sm text-muted-foreground">เริ่ม</label>
                    <input
                      type="date"
                      value={startDate}
                      onChange={(e) => setStartDate(e.target.value)}
                      className="w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
                    />
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm text-muted-foreground">สิ้นสุด</label>
                    <input
                      type="date"
                      value={endDate}
                      onChange={(e) => setEndDate(e.target.value)}
                      className="w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
                    />
                  </div>
                </>
              )}
            </div>
          </section>

          {/* ประเภทการให้บริการและทัศนคติ */}
          <section>
            <div className="mb-3 text-lg font-semibold">ประเภทการให้บริการ และทัศนคติ</div>
            <div className="grid grid-cols-1 gap-4 md:grid-cols-2">
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">บริการ</label>
                <Select value={serviceType} onValueChange={setServiceType}>
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกประเภทบริการ" />
                  </SelectTrigger>
                  <SelectContent>
                    {serviceTypeOptions.map((x) => (
                      <SelectItem key={x} value={x}>
                        {x}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>

              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">ทัศนคติ</label>
                <Select value={sentiment} onValueChange={(v: any) => setSentiment(v)}>
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกทัศนคติ" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">ทั้งหมด</SelectItem>
                    <SelectItem value="positive">เชิงบวก</SelectItem>
                    <SelectItem value="negative">เชิงลบ</SelectItem>
                  </SelectContent>
                </Select>
              </div>
            </div>
          </section>

          {/* ประเภท / หมวดหมู่ ความคิดเห็น */}
          <section>
            <div className="mb-3 text-lg font-semibold">ประเภท / หมวดหมู่ ความคิดเห็น</div>
            <div className="grid grid-cols-1 gap-4 md:grid-cols-2">
              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">หัวข้อ</label>
                <Select
                  value={headCat}
                  onValueChange={(v: any) => {
                    setHeadCat(v);
                    setSubCat("all");
                  }}
                >
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกหัวข้อการประเมิน" />
                  </SelectTrigger>
                  <SelectContent>
                    {HEAD_CATEGORIES.map((c) => (
                      <SelectItem key={c.value} value={c.value as string}>
                        {c.label}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>

              <div className="space-y-2">
                <label className="text-sm text-muted-foreground">หมวดหมู่</label>
                <Select value={subCat} onValueChange={setSubCat} disabled={headCat === "all"}>
                  <SelectTrigger>
                    <SelectValue placeholder="เลือกหมวดย่อย" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">ทั้งหมด</SelectItem>
                    {subcatList.map((x) => (
                      <SelectItem key={x.code} value={x.code}>
                        {x.code} {x.label}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>
            </div>
          </section>
        </CardContent>
      </Card>

      {/* Results */}
      <div className="flex items-center justify-between">
        <h2 className="text-xl font-semibold">
          ผลการค้นหา <span className="text-muted-foreground">({filtered.length} รายการ)</span>
        </h2>
      </div>

      <div className="space-y-4">
        {filtered.map((f) => {
          const codes = pickTagCodes(f);
          const severe =
            Object.values(f.sentiment).some((v) => v === -1) || f.satisfaction.overall <= 2;

          return (
            <Card
              key={f.id}
              className={severe ? "border-red-200 bg-rose-50" : "border-border bg-background"}
            >
              <CardContent className="p-4">
                {/* Header line */}
                <div className="mb-2 flex flex-wrap gap-x-4 gap-y-1 text-sm text-muted-foreground">
                  <span>
                    <strong>รหัส:</strong> {f.id}
                  </span>
                  <span>
                    <strong>วันที่:</strong> {f.date} {f.timestamp}
                  </span>
                  <span>
                    <strong>พื้นที่:</strong> {f.branch.region} / {f.branch.district} /{" "}
                    {f.branch.branch}
                  </span>
                  <span>
                    <strong>บริการ:</strong> {f.serviceType}
                  </span>
                </div>

                {/* Comment */}
                <p className="mb-3 text-foreground leading-relaxed">{f.comment}</p>

                {/* Subtopics */}
                {codes.length > 0 && (
                  <div className="flex flex-wrap gap-2">
                    {codes.map((c) => (
                      <Badge
                        key={c}
                        variant={severe ? "destructive" : "secondary"}
                        className="text-xs"
                      >
                        {c} {LABEL_BY_CODE[c] ?? ""}
                      </Badge>
                    ))}
                  </div>
                )}
              </CardContent>
            </Card>
          );
        })}

        {filtered.length === 0 && (
          <Card>
            <CardContent className="p-8 text-center text-muted-foreground">
              ไม่พบข้อมูลที่ตรงกับตัวกรอง
            </CardContent>
          </Card>
        )}
      </div>
    </div>
  );
}
